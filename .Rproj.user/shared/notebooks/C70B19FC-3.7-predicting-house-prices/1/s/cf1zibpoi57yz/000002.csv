"0","k <- 4"
"0","indices <- sample(1:nrow(train_data))"
"0","folds <- cut(indices, breaks = k, labels = FALSE)"
"0","num_epochs <- 100"
"0","all_scores <- c()"
"0","for (i in 1:k) {"
"0","  cat(""processing fold #"", i, ""\n"")"
"0","  # Prepare the validation data: data from partition # k"
"0","  val_indices <- which(folds == i, arr.ind = TRUE) "
"0","  val_data <- train_data[val_indices,]"
"0","  val_targets <- train_targets[val_indices]"
"0","  "
"0","  # Prepare the training data: data from all other partitions"
"0","  partial_train_data <- train_data[-val_indices,]"
"0","  partial_train_targets <- train_targets[-val_indices]"
"0","  "
"0","  # Build the Keras model (already compiled)"
"0","  model <- build_model()"
"0","  "
"0","  # Train the model (in silent mode, verbose=0)"
"0","  model %>% fit(partial_train_data, partial_train_targets,"
"0","                epochs = num_epochs, batch_size = 1, verbose = 0)"
"0","                "
"0","  # Evaluate the model on the validation data"
"0","  results <- model %>% evaluate(val_data, val_targets, verbose = 0)"
"0","  all_scores <- c(all_scores, results$mean_absolute_error)"
"0","}  "
"1","processing fold #"
"1"," "
"1","1"
"1"," "
"1","
"
"2","2018-02-14 18:30:46.922252: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.2 AVX AVX2 FMA
"
"1","processing fold #"
"1"," "
"1","2"
"1"," "
"1","
"
